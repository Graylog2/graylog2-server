rule "lookup_all"
when
    true
then
    let json = parse_json(to_string($message.json_with_arrays));
            let selectedPath = select_jsonpath(json: json,
                paths: { numbers: "$.numbers[*].value",
                         number: "$.numbers[0].value",
                         decimals: "$.decimals[*].value",
                         booleans: "$.booleans[*].value",
                         strings: "$.strings[*].value"});

    set_field("json_numbers_results", lookup_all("table", selectedPath.numbers));
    set_field("json_decimals_results", lookup_all("table", selectedPath.decimals));
    set_field("json_strings_results", lookup_all("table", selectedPath.strings));

    set_field("numbers_results", lookup_all("table", [1, 2, 3]));
    set_field("decimals_results", lookup_all("table", [1.1, 2.2, 3.3]));
    set_field("strings_results", lookup_all("table", ["one", "two", "three"]));

    trigger_test();
end
